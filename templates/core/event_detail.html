{% extends "base.html" %}
{% load static %}

{% block title %}–ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ–±—ã—Ç–∏—è...{% endblock %}

{% block content %}
<div id="event-detail-content">
    <div class="text-center py-5">
        <div class="spinner-border text-primary" style="width: 3rem; height: 3rem;" role="status">
            <span class="visually-hidden">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
        </div>
    </div>
</div>

<div class="d-none" id="content-template"> </div>

<div id="main-layout" class="row g-4 d-none">
    
    <div class="col-lg-8">
        
        <!-- –ï–î–ò–ù–ê–Ø –ì–ê–õ–ï–†–ï–Ø (–ì–ª–∞–≤–Ω–æ–µ —Ñ–æ—Ç–æ + –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ) -->
        <div class="card shadow-sm mb-4 border-0 overflow-hidden">
            <!-- –°–ø–∏–Ω–Ω–µ—Ä –≤–Ω—É—Ç—Ä–∏ –≥–∞–ª–µ—Ä–µ–∏ (–ø–æ–∫–∞ –≥—Ä—É–∑–∏—Ç—Å—è –ø—Ä–µ–≤—å—é) -->
            <div id="gallery-loader" class="d-flex justify-content-center align-items-center bg-light" style="height: 400px;">
                <div class="spinner-border text-primary" role="status"></div>
            </div>

            <!-- –°–∞–º–∞ –∫–∞—Ä—É—Å–µ–ª—å (–∏–∑–Ω–∞—á–∞–ª—å–Ω–æ —Å–∫—Ä—ã—Ç–∞) -->
            <div id="mainCarousel" class="carousel slide d-none" data-bs-ride="carousel">
                <!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã (—Ç–æ—á–∫–∏ –≤–Ω–∏–∑—É) -->
                <div class="carousel-indicators" id="carousel-indicators">
                    <!-- JS –∑–∞–ø–æ–ª–Ω–∏—Ç -->
                </div>

                <!-- –°–ª–∞–π–¥—ã -->
                <div class="carousel-inner" id="carousel-inner">
                    <!-- JS –∑–∞–ø–æ–ª–Ω–∏—Ç -->
                </div>

                <!-- –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è (–±—É–¥—É—Ç –ø–æ–∫–∞–∑–∞–Ω—ã, –µ—Å–ª–∏ —Å–ª–∞–π–¥–æ–≤ > 1) -->
                <button class="carousel-control-prev d-none" id="btn-prev" type="button" data-bs-target="#mainCarousel" data-bs-slide="prev">
                    <span class="carousel-control-prev-icon bg-dark bg-opacity-50 rounded-circle p-3" aria-hidden="true"></span>
                    <span class="visually-hidden">–ü—Ä–µ–¥—ã–¥—É—â–∏–π</span>
                </button>
                <button class="carousel-control-next d-none" id="btn-next" type="button" data-bs-target="#mainCarousel" data-bs-slide="next">
                    <span class="carousel-control-next-icon bg-dark bg-opacity-50 rounded-circle p-3" aria-hidden="true"></span>
                    <span class="visually-hidden">–°–ª–µ–¥—É—é—â–∏–π</span>
                </button>

                <!-- –†–µ–π—Ç–∏–Ω–≥ –ø–æ–≤–µ—Ä—Ö —Å–ª–∞–π–¥–µ—Ä–∞ -->
                <span class="position-absolute top-0 end-0 m-3 badge bg-warning text-dark fs-6 shadow z-3">
                    ‚òÖ <span id="event-rating">0</span>/25
                </span>
            </div>
        </div>

        <!-- –û–ø–∏—Å–∞–Ω–∏–µ -->
        <div class="card shadow-sm mb-4 border-0">
            <div class="card-body">
                <h2 id="event-title" class="card-title mb-3 fw-bold"></h2>
                <hr>
                <div id="event-description" class="card-text text-secondary" style="line-height: 1.8;"></div>
            </div>
        </div>
    </div>

    <div class="col-lg-4">
        <div class="card shadow-sm mb-4 border-0">
            <div class="card-header bg-primary text-white">
                <h5 class="mb-0">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h5>
            </div>
            <div class="card-body">
                <ul class="list-unstyled mb-0">
                    <li class="mb-3">
                        <strong class="d-block text-muted small text-uppercase">–ù–∞—á–∞–ª–æ</strong>
                        <span id="event-start" class="fs-5"></span>
                    </li>
                    <li class="mb-3">
                        <strong class="d-block text-muted small text-uppercase">–ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ</strong>
                        <span id="event-end" class="fs-5"></span>
                    </li>
                    <li class="mb-3">
                        <strong class="d-block text-muted small text-uppercase">–ú–µ—Å—Ç–æ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è</strong>
                        <span id="venue-name" class="fw-bold"></span>
                        <br>
                        <a id="venue-coords" href="#" target="_blank" class="small text-decoration-none">üìç –ü–æ–∫–∞–∑–∞—Ç—å –Ω–∞ –∫–∞—Ä—Ç–µ</a>
                    </li>
                </ul>
            </div>
        </div>

        <!-- –í–∏–¥–∂–µ—Ç –ü–æ–≥–æ–¥—ã -->
        <div id="weather-block" class="card shadow-sm border-0 d-none" style="background: linear-gradient(135deg, #e0f7fa 0%, #80deea 100%);">
            <div class="card-body text-center">
                <h5 class="card-title text-primary-emphasis mb-3">‚õÖ –ü–æ–≥–æ–¥–∞ –Ω–∞ –º–µ—Å—Ç–µ</h5>
                
                <div class="display-4 fw-bold text-dark mb-2">
                    <span id="weather-temp"></span>¬∞C
                </div>
                
                <div class="row text-muted small border-top border-secondary pt-2 mt-2">
                    <div class="col-4 border-end border-secondary">
                        <div class="fw-bold">–í–ª–∞–∂–Ω–æ—Å—Ç—å</div>
                        <span id="weather-humidity"></span>%
                    </div>
                    <div class="col-4 border-end border-secondary">
                        <div class="fw-bold">–í–µ—Ç–µ—Ä</div>
                        <span id="weather-wind"></span> –º/—Å
                    </div>
                    <div class="col-4">
                        <div class="fw-bold">–î–∞–≤–ª–µ–Ω–∏–µ</div>
                        <span id="weather-pressure"></span>
                    </div>
                </div>
                
                <!-- –í–∞–∂–Ω–æ–µ –ø—Ä–∏–º–µ—á–∞–Ω–∏–µ -->
                <div class="mt-3 small text-muted fst-italic border-top border-secondary-subtle pt-2">
                    <span id="weather-note">* –î–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏</span>
                </div>
            </div>
        </div>

        <div class="d-grid mt-4">
            <a href="/" class="btn btn-outline-secondary">‚Üê –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ —Å–ø–∏—Å–∫—É</a>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    window.eventId = {{ event_id }};

    function showContent() {
        document.getElementById('event-detail-content').classList.add('d-none');
        document.getElementById('main-layout').classList.remove('d-none');
    }

</script>
<script src="{% static 'js/detail.js' %}"></script>
<script>
    const originalRender = renderEvent;
    renderEvent = function(data) {
        originalRender(data);
        showContent();
    }
</script>
{% endblock %}
